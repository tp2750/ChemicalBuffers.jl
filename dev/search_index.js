var documenterSearchIndex = {"docs":
[{"location":"theory/#ChemicalBuffers-Theory","page":"Theory","title":"ChemicalBuffers Theory","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"The computation is based on the method described in https://www.mdpi.com/2624-8549/3/2/34","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"This is based on activities ","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Ka_i = H^+H_n-iA^-H_nA","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Notes: (§1.2)","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"The present review follows the first approach: the hydrochemical approach (based on dissociation reactions with reference state HNA)\nit is assumed that the activities (that enter the mass action laws) are replaced by molar concentrations, which is justified either for dilute systems or for non-dilute systems using conditional equilibrium constants \nCentral formula: n = Y1 + w/CT","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Overview:","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"§2.1: 1-component system\n§2.2: 3 component acid-base system\n§2.3: buffer capacities and intensities\n§2.4: auto proteolysis\n§2.5: perspectivation\n§3: Activities and concentrations?\n§4: zwitterions\nAppendix B: Effective concentrations: j = gamma_jj","category":"page"},{"location":"theory/#Notation","page":"Theory","title":"Notation","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"beginaligned\nj = H_N-jA^j hbox Molar concentration of acid specis (2) \nC_T = H_NA_T = sum_j=0^N j (4) \nj = gamma_jj hbox activity of acid species j (5) \nx   = H^+ = 10^-pH  hbox activity of H+ (6) \nK_w = H^+OH^- (7) \nK_w = 10E-14 hboxat 25C \nw(x) = OH^- - H^+ = K_wx - xgamma_H (8) \nK_a = H^+A^-HA (10) \n^cK_a = H^+A^-HA (11) \npKa = -ln(Ka) (12) \nk_0 = 1 \nk_j = Pi_i = 1^j K_i = H^+^jH_N-jA^-jH_N A (12) \nk_j = x^j j  0 \nj = k_jx^j 0 for all j (14)  \nC_T = sum j = 0 sum_j=0^N k_jx^j (15) hboxmass ballance \na_j = jC_T (16) hboxionization fractions \nendaligned","category":"page"},{"location":"theory/#Ionization-function","page":"Theory","title":"Ionization function","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"We implement equation (17) as function ionization_fractions_gamma1 and define a plot recipe for BufferComponent using that.","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"a_j = left( frack_jx^j right) a_0 a_0 = left( sum_j=0^N frack_jx^jright)^-1","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"using ChemicalBuffers\nusing Plots\nplot(plot(acetic_acid), plot(carbonic_acid), plot(citric_acid), plot(phosphoric_acid))","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"(Image: Fractions1)","category":"page"},{"location":"theory/#Appendix","page":"Theory","title":"Appendix","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"A similar approach is described in this answer: https://chemistry.stackexchange.com/questions/149282/how-to-numerically-model-a-phosphoric-acid-titration-curve/149285#149285 . An R implementation based on that can be found here: https://github.com/naikymen/titration","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"It is also the method used in https://www.egr.msu.edu/~scb-group-web/buffers/buffers.html and in the python library pHcalc https://github.com/rnelsonchem/pHcalc.","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"I have my own implementation of that here: https://github.com/tp2750/pHcalc.jl","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"There is now even a version in the registry: https://github.com/egonik-unlp/PHcalc.jl","category":"page"},{"location":"theory/#Cut","page":"Theory","title":"Cut","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"https://chemistry.stackexchange.com/questions/149282/how-to-numerically-model-a-phosphoric-acid-titration-curve/149285#149285 .","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"This works for phosphoric acid and similar buffers, but perhaps not generally?","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Given pH and pKa values, we can compute the relative ratios of the protonation species.\nThis implies how much metal ion is needed to get net charge zero.\nGiven the total buffer strength, determines the actual concentration of the salts.","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Actually, it is the activities, not the pKa values, see https://www.mdpi.com/2624-8549/3/2/34","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"$","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Kai = {H^+}{H{n-i}A^-}/{H_nA} $","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Note: We should also apply this to large proteins.","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Based on https://www.mdpi.com/2624-8549/3/2/34","category":"page"},{"location":"design/#ChemicalBuffers-Mental-Model","page":"Design","title":"ChemicalBuffers Mental Model","text":"","category":"section"},{"location":"design/","page":"Design","title":"Design","text":"This section is about how the code is organized and which data structures are used.","category":"page"},{"location":"design/#Buffers","page":"Design","title":"Buffers","text":"","category":"section"},{"location":"design/","page":"Design","title":"Design","text":"The package has a library of known buffers. These can be used by name, as we saw in the tutorial. Later we will see how to define a new buffer.","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"The know buffers are listed in Appendix A.","category":"page"},{"location":"design/#Buffer-Data-Structure","page":"Design","title":"Buffer Data Structure","text":"","category":"section"},{"location":"design/","page":"Design","title":"Design","text":"A buffer is defined by a vector of buffer components:","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"struct Buffer\n    name::String\n    components::Vector{BufferComponent}\n    hazards::Union{Vector{Int64}, Missing}\n    precautions::Union{Vector{Int64}, Missing}\n    uv_limit::Union{Float64,String,Missing} ## https://www.reachdevices.com/Protein/BiologicalBuffers.html\n    notes::String                   ## https://www.reachdevices.com/Protein/BiologicalBuffers.html\nend","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"A buffer component is defined by its pKa^0 values:","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"struct BufferComponent\n    name::String\n    pKa0_25C::Vector{Float64}\n    dpKa_dt::Float64\n    notes::String\nend","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"A buffer stock is a list of buffer component solutions","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"struct ComponentSolution\n    name::String\n    buffer_component::BufferComponent\n    molarity_M::Float64\n    volume_L::Float64\nend\n\nstruct BufferStock\n    name::String\n    stock_solutions::Vector{ComponentSolution}\nend","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"Finally, a buffer solution is mix of the stocks with water:","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"struct BufferSolution\n    name::String\n    stock_aliquots::Vector{ComponentSolution}\n    volume_L::Float64\nend","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"The stockaliquots contain the amount used, and `volumeL` is the total volume of buffer solution.","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"To compute the recipes, we need to know the possible salts to use","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"struct Salt\n    name::String\n    formula::String\n    molecular_weight::Float64\n    hydration::Int64\n    solubility::Vector{Solubility} ## interpolate between known solubilities. Hint if heating or cooling helps (endothermal / exothermal)\n    hazards::Union{Vector{Int64}, Missing}\n    precautions::Union{Vector{Int64}, Missing}\n    notes::String\nend\n\nstruct Solubility ## g/L @ temperature\n    solubility_g_L::Float64    \n    solubility_temp_C::Float64\nend","category":"page"},{"location":"design/#Methods-on-a-buffer-solution","page":"Design","title":"Methods on a buffer solution","text":"","category":"section"},{"location":"design/#pH","page":"Design","title":"pH","text":"","category":"section"},{"location":"design/","page":"Design","title":"Design","text":"We can check the pH of a buffer solution. The pH depends on the temperature. So we can check the pH at a different temperature, than the one we designed for.","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"using ChemicalBuffers\nphos = buffer(\"Phosphate\");\nphos_stock = buffer_stocks(phos, M = 1.0);\nphos_100_6.0 = buffer(phos_stock, pH = 6.0, M = 0.1, T=25);\n\npH(phos_100_6.0, T=25)\n# 6.00","category":"page"},{"location":"design/#Recipes","page":"Design","title":"Recipes","text":"","category":"section"},{"location":"design/","page":"Design","title":"Design","text":"We can get the recipe of the buffer solution based on the stock solutions (as a Data Frame):","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"recipe(phos_100_6.0, L = 1.0)","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"And we can print it (as markdown, html, text, odt, docx, ods, xlsx) using print_recipe:","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"print_recipe(phos_100_6.0, L = 1.0, file = \"phosphate_buffer.docx\")","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"We can also get the recipe of the stock solutions: ","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"recipe(phos_stock, L = 1.0)","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"For the stock solutions, there is a default hydration of the salt, but other hydration levels can be specified or all can be printed for information.","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"recipe(phos_stock, all_hydrates=true)\nrecipe(phos_stock, hydrates = [0,0], L = 1.0)","category":"page"},{"location":"design/#Buffer-strength","page":"Design","title":"Buffer strength","text":"","category":"section"},{"location":"design/","page":"Design","title":"Design","text":"buffer_strength(phos_100_6.0)\n# 0.1 M","category":"page"},{"location":"design/#Buffer-capacity","page":"Design","title":"Buffer capacity","text":"","category":"section"},{"location":"design/","page":"Design","title":"Design","text":"Check with https://www.egr.msu.edu/~scb-group-web/buffers/buffers.html","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"buffer_capacity(phos_100_6.0)\n# 27.01 mM NaOH / pH","category":"page"},{"location":"design/#Titration-Curve","page":"Design","title":"Titration Curve","text":"","category":"section"},{"location":"design/","page":"Design","title":"Design","text":"tc = titration_curve(phos_100_6.0)\nusing Plots\nplot(tc)","category":"page"},{"location":"design/#Ionic-strength","page":"Design","title":"Ionic strength","text":"","category":"section"},{"location":"design/","page":"Design","title":"Design","text":"ionic_strength(phos_100_6.0)","category":"page"},{"location":"design/#pKa-values","page":"Design","title":"pKa values","text":"","category":"section"},{"location":"design/","page":"Design","title":"Design","text":"The effective pKa values of a component solution. This depends on ionic stregnth and temperature.","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"We use this internally.  Several methods can be chosen:","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"Debye-Huckel parameters: A","category":"page"},{"location":"design/#Functions","page":"Design","title":"Functions","text":"","category":"section"},{"location":"design/","page":"Design","title":"Design","text":"Functions used to implement the functionality:","category":"page"},{"location":"design/#Appendix-A:-List-of-known-buffers","page":"Design","title":"Appendix A: List of known buffers","text":"","category":"section"},{"location":"design/","page":"Design","title":"Design","text":"Phospahte\nBritton-Robinson\nBritton-Robinson citric\nBritton-Robinson-Nakagava (https://www.researchgate.net/publication/301623974DevelopmentofamodifiedBritton-RobinsonbufferwithimprovedlinearityinthealkalinepHregion)\nGlycine-HCL\nSodium Acetate\nCacodylate\nCitrate\nPhosphate-Citrate\nBarbital\nTris\nGlycine","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"Goods buffers: https://www.reachdevices.com/Protein/BiologicalBuffers.html | Buffer             | pKa  | Date added | | –                 | –   | –         | | MES                | 6.15 | 1966       | | Bis-tris methane   | 6.60 |            | | ADA                | 6.62 | 1966       | | Bis-tris propane   | 6.80 |            | | PIPES              | 6.82 | 1966       | | ACES               | 6.88 | 1966       | | MOPSO              | 6.95 | 1980       | | Cholamine chloride | 7.10 | 1966       | | MOPS               | 7.15 | 1972       | | BES                | 7.17 | 1966       | | TES                | 7.5  | 1966       | | HEPES              | 7.55 | 1966       | | DIPSO              | 7.6  | 1980       | | MOBS               | 7.6  |            | | Acetamidoglycine   | 7.7  | 1966       | | TAPSO              | 7.6  | 1980       | | TEA                | 7.8  |            | | POPSO              | 7.85 | 1980       | | HEPPSO             | 7.9  | 1980       | | EPS                | 8.0  |            | | HEPPS              | 8.1  | 1972       | | Tricine            | 8.15 | 1966       | | Tris               | 8.2  | 1966       | | Glycinamide        | 8.2  | 1966       | | Glycylglycine      | 8.2  | 1966       | | HEPBS              | 8.3  |            | | Bicine             | 8.35 | 1966       | | TAPS               | 8.55 | 1972       | | AMPB               | 8.8  |            | | CHES               | 9.3  |            | | CAPSO              | 9.6  |            | | AMP                | 9.7  |            | | CAPS               | 10.4 |            | | CABS               | 10.7 |            |","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"Derived buffers: https://microscopy.berkeley.edu/buffers-and-buffer-tables/","category":"page"},{"location":"design/","page":"Design","title":"Design","text":"EDTA\nSSC\nSSPE\nTE\nSTE (TNE)\nPBS\nTBS\nTNT\nPBT","category":"page"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = ChemicalBuffers","category":"page"},{"location":"#ChemicalBuffers","page":"Home","title":"ChemicalBuffers","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Documentation for ChemicalBuffers.","category":"page"},{"location":"","page":"Home","title":"Home","text":"Pages = [\n        \"index.md\",\n        \"tutorial.md\",\n        \"design.md\",\n        \"theory.md\",\n    ]","category":"page"},{"location":"","page":"Home","title":"Home","text":"Modules = [ChemicalBuffers]","category":"page"},{"location":"tutorial/#ChemicalBuffers-Tutorial","page":"Tutorial","title":"ChemicalBuffers Tutorial","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"In this example, we make 1 L of a 100 mM Phosphate buffer at pH 6.0 using 1 M stock solutions.","category":"page"},{"location":"tutorial/#Generate-the-stock-solutions","page":"Tutorial","title":"Generate the stock solutions","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Below we generate a 100 mM phospahte buffer with a pH of 6.0 at 25C.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"using ChemicalBuffers\nphos = buffer(\"Phosphate\");\nphos_stock = buffer_stocks(phos, M = 1.0);\nphos_100_6.0 = buffer(phos_stock, pH = 6.0, M = 0.1, T=25);","category":"page"},{"location":"tutorial/#Printing-recipe","page":"Tutorial","title":"Printing recipe","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"We can print recipies using the print_recipe function. Below we make 1 L:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"print_recipe(phos_100_6.0, L = 1.0)","category":"page"},{"location":"tutorial/#L-100-mM-pH-6.0-Phosphate-Buffer","page":"Tutorial","title":"1 L 100 mM pH 6.0 Phosphate Buffer","text":"","category":"section"},{"location":"tutorial/#Stock-Solutions","page":"Tutorial","title":"Stock Solutions","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"1 M Monosodium phosphate\n1 M Disodium phosphate","category":"page"},{"location":"tutorial/#L-100-mM-pH-6.0-Phosphate-buffer","page":"Tutorial","title":"1 L 100 mM pH 6.0 Phosphate buffer","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Stock solution volume (mL) Notes\n1 M Monosodium phosphate 86.47 WARNIG! H290: May be corrosive to metals, H314: Casuses severe skin burns and eye damage\n1 M Disodium phosphate 13.53 WARNIG! H290: May be corrosive to metals, H314: Casuses severe skin burns and eye damage\nH2O 900 ","category":"page"},{"location":"tutorial/#Printing-recipe-of-stock-solution","page":"Tutorial","title":"Printing recipe of stock solution","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"We prepare 1 L of each of the stocks:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"print_recipe(phos_stock, L = 1.0)","category":"page"},{"location":"tutorial/#L-1-M-Phosphate-buffer-stock-solutions","page":"Tutorial","title":"1 L 1 M Phosphate buffer stock solutions","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Stock Solution Salt CAS weigth (g) H2O (mL) MW (g/mol) Formula Notes\n1L 1M Monosodium phosphate Monosodium phosphate, monohydrate 10049-21-5 137.99 1000 137.99 NaH2PO4·H2O WARNIG! H290: May be corrosive to metals, H314: Casuses severe skin burns and eye damage\n1L 1M Disodium phosphate Disodium phosphate, heptahydrate 7782-85-6 268.07 1000 268.07 Na2HPO4·7H2O WARNIG! H290: May be corrosive to metals, H314: Casuses severe skin burns and eye damage","category":"page"},{"location":"tutorial/#Hydration","page":"Tutorial","title":"Hydration","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"We can explore other hydration options for the salts using an option:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"print_recipe(phos_stock, all_hydrates=true)","category":"page"},{"location":"tutorial/#Stock-Solutions-Phosphate-buffer","page":"Tutorial","title":"Stock Solutions Phosphate buffer","text":"","category":"section"},{"location":"tutorial/#L-1M-Monosodium-phosphate","page":"Tutorial","title":"1L 1M Monosodium phosphate","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Stock Solution Salt CAS weigth (g) H2O (mL) MW (g/mol) Formula Notes\n1L 1M Monosodium phosphate Monosodium phosphate, anhydrate 7558-80-7 119.98 1000 119.98 NaH2PO4 WARNIG! H290: May be corrosive to metals, H314: Casuses severe skin burns and eye damage\n1L 1M Monosodium phosphate Monosodium phosphate, monohydrate 10049-21-5 137.99 1000 137.99 NaH2PO4·H2O WARNIG! H290: May be corrosive to metals, H314: Casuses severe skin burns and eye damage\n1L 1M Monosodium phosphate Monosodium phosphate, dihydrate 13472-35-0 156.01 1000 156.01 NaH2PO4·2H2O WARNIG! H290: May be corrosive to metals, H314: Casuses severe skin burns and eye damage","category":"page"},{"location":"tutorial/#L-1M-Disodium-phosphate","page":"Tutorial","title":"1L 1M Disodium phosphate","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Stock Solution Salt CAS weigth (g) H2O (mL) MW (g/mol) Formula Notes\n1L 1M Disodium phosphate Disodium phosphate, anhydrate 7558-79-4 141.96 1000 141.96 Na2HPO4 WARNIG! H290: May be corrosive to metals, H314: Casuses severe skin burns and eye damage\n1L 1M Disodium phosphate Disodium phosphate, dihydrate 10028-24-7 177.99 1000 177.99 Na2HPO4·2H2O WARNIG! H290: May be corrosive to metals, H314: Casuses severe skin burns and eye damage\n1L 1M Disodium phosphate Disodium phosphate, heptahydrate 7782-85-6 268.07 1000 268.07 Na2HPO4·7H2O WARNIG! H290: May be corrosive to metals, H314: Casuses severe skin burns and eye damage\n1L 1M Disodium phosphate Disodium phosphate, dodecahydrate 10039-32-4 358.14 1000 358.14 Na2HPO4·12H2O WARNIG! H290: May be corrosive to metals, H314: Casuses severe skin burns and eye damage","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"When we have chosen the one we want, we can print the recipe to use:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"print_recipe(phos_stock, hydrates = [0,0], L = 1.0)","category":"page"},{"location":"tutorial/#L-1-M-Phosphate-buffer-stock-solutions-2","page":"Tutorial","title":"1 L 1 M Phosphate buffer stock solutions","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Stock Solution Salt CAS weigth (g) H2O (mL) MW (g/mol) Formula Notes\n1L 1M Monosodium phosphate Monosodium phosphate, anhydrate 7558-80-7 119.98 1000 119.98 NaH2PO4 WARNIG! H290: May be corrosive to metals, H314: Casuses severe skin burns and eye damage\n1L 1M Disodium phosphate Disodium phosphate, anhydrate 7558-79-4 141.96 1000 141.96 Na2HPO4 WARNIG! H290: May be corrosive to metals, H314: Casuses severe skin burns and eye damage","category":"page"}]
}
